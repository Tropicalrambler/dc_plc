{"version":3,"file":"dc_plc.min.js","sources":["../../../../apps/dc_plc/dc_plc/public/js/export_tool/ToolRoot.vue?rollup-plugin-vue=script.js","../../../../apps/dc_plc/dc_plc/public/js/export_tool/ToolRoot.vue","../../../../apps/dc_plc/dc_plc/public/js/export_tool/export_tool.js","../../../../apps/dc_plc/dc_plc/public/js/dc_plc.js"],"sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tname: \"ToolRoot\",\n\tdata() {\n\t\treturn {\n\t\t\tproduct_ids: [],\n\t\t\tstate: '',\n\t\t}\n\t},\n\tcomputed: {\n\t\tproductsToExport: function () {\n\t\t\tif (!this.product_ids.length) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tlet prod_data = [];\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"dc_plc.controllers.export_tool.export_product_numbers\",\n\t\t\t\targs: {\n\t\t\t\t\tids: this.product_ids.sort(),\n\t\t\t\t},\n\t\t\t\tasync: false,\n\t\t\t\tcallback: r => {\n\t\t\t\t\tprod_data = r.message;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn prod_data;\n\t\t}\n\t},\n\tmethods: {\n\t\ttoggleSelection(rows) {\n\t\t\tif (rows) {\n\t\t\t\trows.forEach(row => {\n\t\t\t\t\tthis.$refs.exportTable.toggleRowSelection(row);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.$refs.exportTable.clearSelection();\n\t\t\t}\n\t\t},\n\t\tquerySearchAsync(queryString, cb) {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"dc_plc.controllers.export_tool.export_product_search\",\n\t\t\t\targs: {\n\t\t\t\t\tquery: queryString,\n\t\t\t\t},\n\t\t\t\tcallback: r => {\n\t\t\t\t\tcb(r.message);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\thandleAutocompleteSelect(item) {\n\t\t\tlet id = this.state;\n\t\t\tif (this.product_ids.indexOf(id) === -1) {\n\t\t\t\tlet arr = [...this.product_ids];\n\t\t\t\tarr.push(id);\n\t\t\t\tarr.sort();\n\t\t\t\tthis.product_ids = arr;\n\t\t\t\tconsole.log(this.product_ids);\n\t\t\t}\n\t\t\tthis.state = '';\n\t\t},\n\t\thandleDelete(row_index, row_object) {\n\t\t\tthis.product_ids.splice(row_index, 1);\n\t\t}\n\t},\n}\n","<template>\n\t<div>\n\t\t<el-table\n\t\t\t\tref=\"exportTable\"\n\t\t\t\tv-bind:data=\"productsToExport\"\n\t\t\t\tstyle=\"width: 100%\">\n\t\t\t<el-table-column property=\"number\" label=\"№\" width=\"40\"></el-table-column>\n\t\t\t<el-table-column property=\"ext_num\" label=\"Внешний номер\" width=\"200\"></el-table-column>\n\t\t\t<el-table-column property=\"int_num\" label=\"Внутрений нормер\" width=\"200\"></el-table-column>\n\t\t\t<el-table-column property=\"rnd_proj\" label=\"ОКР\" width=\"300\"></el-table-column>\n\t\t\t<el-table-column align=\"center\" width=\"80\">\n\t\t\t\t<template slot-scope=\"scope\">\n\t\t\t\t\t<el-button\n\t\t\t\t\t\t\tsize=\"mini\"\n\t\t\t\t\t\t\ttype=\"danger\"\n\t\t\t\t\t\t\ticon=\"el-icon-delete\"\n\t\t\t\t\t\t\tplain\n\t\t\t\t\t\t\t@click=\"handleDelete(scope.$index, scope.row)\">\n\t\t\t\t\t</el-button>\n\t\t\t\t</template>\n\t\t\t</el-table-column>\n\t\t</el-table>\n\t\t<div style=\"margin-top: 20px\">\n\t\t\t<el-autocomplete\n\t\t\t\t\tplaceholder=\"Поиск...\"\n\t\t\t\t\tv-model=\"state\"\n\t\t\t\t\tpopper-class=\"product-autocomplete\"\n\t\t\t\t\tv-bind:fetch-suggestions=\"querySearchAsync\"\n\t\t\t\t\tv-on:select=\"handleAutocompleteSelect\"\n\t\t\t\t\tv-bind:trigger-on-focus=\"false\">\n\t\t\t\t<template slot-scope=\"{ item }\">\n\t\t\t\t\t<div class=\"suggestion-item\">\n\t\t\t\t\t\t<div class=\"ext_num\">Внеш.: {{ item.ext_num }}</div>\n\t\t\t\t\t\t<div class=\"int_num\">Внут.: {{ item.int_num }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</el-autocomplete>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\n\texport default {\n\t\tname: \"ToolRoot\",\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tproduct_ids: [],\n\t\t\t\tstate: '',\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t\tproductsToExport: function () {\n\t\t\t\tif (!this.product_ids.length) {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t\tlet prod_data = [];\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"dc_plc.controllers.export_tool.export_product_numbers\",\n\t\t\t\t\targs: {\n\t\t\t\t\t\tids: this.product_ids.sort(),\n\t\t\t\t\t},\n\t\t\t\t\tasync: false,\n\t\t\t\t\tcallback: r => {\n\t\t\t\t\t\tprod_data = r.message;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn prod_data;\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\ttoggleSelection(rows) {\n\t\t\t\tif (rows) {\n\t\t\t\t\trows.forEach(row => {\n\t\t\t\t\t\tthis.$refs.exportTable.toggleRowSelection(row);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.$refs.exportTable.clearSelection();\n\t\t\t\t}\n\t\t\t},\n\t\t\tquerySearchAsync(queryString, cb) {\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"dc_plc.controllers.export_tool.export_product_search\",\n\t\t\t\t\targs: {\n\t\t\t\t\t\tquery: queryString,\n\t\t\t\t\t},\n\t\t\t\t\tcallback: r => {\n\t\t\t\t\t\tcb(r.message);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\thandleAutocompleteSelect(item) {\n\t\t\t\tlet id = this.state;\n\t\t\t\tif (this.product_ids.indexOf(id) === -1) {\n\t\t\t\t\tlet arr = [...this.product_ids];\n\t\t\t\t\tarr.push(id);\n\t\t\t\t\tarr.sort();\n\t\t\t\t\tthis.product_ids = arr;\n\t\t\t\t\tconsole.log(this.product_ids);\n\t\t\t\t}\n\t\t\t\tthis.state = '';\n\t\t\t},\n\t\t\thandleDelete(row_index, row_object) {\n\t\t\t\tthis.product_ids.splice(row_index, 1);\n\t\t\t}\n\t\t},\n\t}\n</script>\n\n<style>\n\t.product-autocomplete {\n\n\t\tli {\n\t\t\tline-height: normal;\n\t\t\tpadding: 7px;\n\n\t\t\t.suggestion-item {\n\t\t\t\tborder-bottom-width: 1px;\n\t\t\t\tborder-bottom-style: dashed;\n\t\t\t}\n\n\t\t\t.ext_num {\n\t\t\t\ttext-overflow: ellipsis;\n\t\t\t\toverflow: hidden;\n\t\t\t}\n\n\t\t\t.int_num {\n\t\t\t\tfont-size: 12px;\n\t\t\t\tcolor: #b4b4b4;\n\t\t\t}\n\t\t}\n\t}\n</style>","import ToolRoot from './ToolRoot.vue';\n\nfrappe.provide('frappe.dc_plc');\n\nfrappe.dc_plc.ExportTool = class {\n\tconstructor({ parent }) {\n\t\tthis.$parent = $(parent);\n\t\tthis.page = parent.page;\n\t\tthis.setup_header();\n\t\tthis.make_body();\n\t}\n\tmake_body() {\n\t\t$(frappe.render_template('<div id=\"app\"><tool-root></tool-root></div>', this.page)).prependTo(this.$parent.find('.layout-main'));\n\t\tthis.vue = new Vue({\n\t\t\tel: '#app',\n\t\t\tdata: function () {\n\t\t\t\treturn {}\n\t\t\t},\n\t\t\tcomponents: {\n\t\t\t\tToolRoot\n\t\t\t}\n\t\t});\n\t}\n\n\tsetup_header() {\n\t}\n\n\tset_products_ids(ids) {\n\t\tthis.vue.$children[0].product_ids = ids;\n\t}\n};\n","(function () {\n\n\tfrappe.provide('frappe.dc_plc.utils');\n\tfrappe.provide('frappe.dc_plc.utils.handlers');\n\tfrappe.provide('frappe.dc_plc.utils.formatters');\n\n\tfrappe.require('assets/dc_plc/js/utils/formatter.js', () => {\n\t\tfrappe.dc_plc.utils.formatters.mmic_dept_head_formatter = mmic_dept_head_formatter;\n\t\tfrappe.dc_plc.utils.formatters.rnd_spec_formatter = rnd_spec_formatter;\n\t\tfrappe.dc_plc.utils.formatters.developer_formatter = developer_formatter;\n\t\tfrappe.dc_plc.utils.formatters.opcon_spec_formatter = opcon_spec_formatter;\n\t\tfrappe.dc_plc.utils.formatters.procmap_spec_formatter = procmap_spec_formatter;\n\t\tfrappe.dc_plc.utils.formatters.desdoc_spec_formatter = desdoc_spec_formatter;\n\t\tfrappe.dc_plc.utils.formatters.tech_writer_formatter = tech_writer_formatter;\n\n\t\tfrappe.dc_plc.utils.formatters.full_stat_formatter = full_stat_formatter;\n\n\t\tfrappe.dc_plc.utils.formatters.function_link_formatter = function_link_formatter;\n\t\tfrappe.dc_plc.utils.formatters.rnd_project_link_formatter = rnd_project_link_formatter;\n\t\tfrappe.dc_plc.utils.formatters.product_type_link_formatter = product_type_link_formatter;\n\t\tfrappe.dc_plc.utils.formatters.package_link_formatter = package_link_formatter;\n\t\tfrappe.dc_plc.utils.formatters.letter_link_formatter = letter_link_formatter;\n\t\tfrappe.dc_plc.utils.formatters.status_link_formatter = status_link_formatter;\n\t});\n\n\tfrappe.require('assets/dc_plc/js/utils/handler.js', () => {\n\t\tfrappe.dc_plc.utils.handlers.mmic_dept_head_handler = mmic_dept_head_handler;\n\t\tfrappe.dc_plc.utils.handlers.rnd_spec_handler = rnd_spec_handler;\n\t\tfrappe.dc_plc.utils.handlers.developer_handler = developer_handler;\n\t\tfrappe.dc_plc.utils.handlers.opcon_spec_handler = opcon_spec_handler;\n\t\tfrappe.dc_plc.utils.handlers.procmap_spec_handler = procmap_spec_handler;\n\t\tfrappe.dc_plc.utils.handlers.desdoc_spec_handler = desdoc_spec_handler;\n\t\tfrappe.dc_plc.utils.handlers.tech_writer_handler = tech_writer_handler;\n\t});\n\n\tfrappe.dc_plc.utils.replaceCharAt = (str, index, char) => {\n\t\tif (index > str.length - 1)\n\t\t\treturn str;\n\t\treturn str.substr(0, index) + char + str.substr(index + 1);\n\t};\n\n\tconsole.log('>>> DC PLC init finished <<<');\n})();\n"],"names":["let","this","const"],"mappings":"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"}